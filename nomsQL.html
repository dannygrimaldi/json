SELECT 
    LEFT(UPPER(TRIM(Datos2)), CHARINDEX(' ', UPPER(TRIM(Datos2))) + LEFT(TRIM(Datos1), 2)) AS [VAR - Nombre],
    RIGHT(UPPER(TRIM(Datos2)), LEN(Datos2) - CHARINDEX(' ', UPPER(TRIM(Datos2))) + RIGHT(LEFT(TRIM(Datos1), 3), 1)) AS [VAR - Apellido Materno],
    RIGHT(UPPER(TRIM(Datos2)), LEN(Datos2) - CHARINDEX(' ', UPPER(TRIM(Datos2))) + LEFT(TRIM(Datos1), 2)) AS [VAR - Apellidos],
    REPLACE([VAR - Apellidos], [VAR - Apellido Materno], '') AS [VAR - Apellido Paterno]
FROM 
    tu_tabla;


SELECT
    CASE 
        WHEN LENGTH(SUBSTRING_INDEX(Nombre_Completo, ' ', 1)) = LENGTH(Nombre_Completo) 
            THEN Nombre_Completo 
            ELSE SUBSTRING_INDEX(Nombre_Completo, ' ', 1) 
    END AS Nombre,
    CASE 
        WHEN LENGTH(SUBSTRING_INDEX(Nombre_Completo, ' ', 1)) = LENGTH(Nombre_Completo) 
            THEN NULL 
            ELSE SUBSTRING_INDEX(Nombre_Completo, ' ', -1) 
    END AS Apellido_Paterno,
    CASE 
        WHEN LENGTH(SUBSTRING_INDEX(SUBSTRING_INDEX(Nombre_Completo, ' ', 2), ' ', -1)) = LENGTH(SUBSTRING_INDEX(Nombre_Completo, ' ', 2)) 
            THEN NULL 
            ELSE SUBSTRING_INDEX(SUBSTRING_INDEX(Nombre_Completo, ' ', 2), ' ', -1) 
    END AS Apellido_Materno,
    CURP
FROM
    TuTabla;




CREATE FUNCTION dbo.SUBSTRING_INDEX
(
    @str NVARCHAR(4000),
    @delim NVARCHAR(1),
    @count INT
)
RETURNS NVARCHAR(4000)
AS
BEGIN
    DECLARE @Result NVARCHAR(4000);

    SET @Result = NULL;

    ;WITH SplitData AS (
        SELECT 
            CAST(0 AS INT) AS StartPos,
            CHARINDEX(@delim, @str) AS EndPos,
            1 AS Occurrence

        UNION ALL

        SELECT 
            EndPos + 1 AS StartPos,
            CHARINDEX(@delim, @str, EndPos + 1) AS EndPos,
            Occurrence + 1 AS Occurrence
        FROM 
            SplitData
        WHERE 
            EndPos > 0
    )
    SELECT TOP 1 @Result = SUBSTRING(@str, StartPos, EndPos - StartPos)
    FROM 
        SplitData
    WHERE 
        Occurrence = @count
    ORDER BY 
        StartPos;

    RETURN @Result;
END
